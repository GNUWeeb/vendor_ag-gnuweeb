From 8ae5f5574bdc22126e59c0cc7cdf345d3e3f87c2 Mon Sep 17 00:00:00 2001
From: Michael Goffioul <michael.goffioul@lincor.com>
Date: Tue, 23 Feb 2021 11:49:59 -0500
Subject: [PATCH 1/2] Don't let "tar" manage compression

It may end up calling "zcat", which is not allowed in the building
sandbox. As "gzip" is present int prebuilts, just change the command to
use "gzip" separately.
---
 wl/Android.mk | 2 +-
 1 file changed, 1 insertion(+), 1 deletion(-)

diff --git a/wl/Android.mk b/wl/Android.mk
index 222d718..fa5e319 100644
--- a/wl/Android.mk
+++ b/wl/Android.mk
@@ -39,7 +39,7 @@ $(WL_SRC):
 	$(hide) mkdir -p $(@D) && /usr/bin/curl -k https://docs.broadcom.com/docs-and-downloads/docs/linux_sta/$(@F) > $@
 
 $(WL_LIB): $(WL_SRC) $(addprefix $(LOCAL_PATH)/,$(WL_PATCHES))
-	$(hide) tar zxf $< -C $(@D) --overwrite -m && \
+	$(hide) gzip -d -c $< | tar xf - -C $(@D) --overwrite -m && \
 		rm -rf $@ && mv $(@D)/lib $@ && touch $@ && \
 		cat $(filter %.patch,$^) | patch -p1 -d $(@D)
 
-- 
2.30.2

