From 17fe6a410d1fc3e10b7d86336917e9d55c6a698a Mon Sep 17 00:00:00 2001
From: Chih-Wei Huang <cwhuang@linux.org.tw>
Date: Wed, 15 Jan 2020 16:48:22 +0800
Subject: [PATCH 21/21] Fix ro.build.fingerprint

Fix mismatched fingerprints, a stupid bug of Android 10.
---
 init/property_service.cpp | 21 ++-------------------
 1 file changed, 2 insertions(+), 19 deletions(-)

diff --git a/init/property_service.cpp b/init/property_service.cpp
index 3f36d6fb0..b80b587e9 100644
--- a/init/property_service.cpp
+++ b/init/property_service.cpp
@@ -890,25 +890,8 @@ static void property_initialize_build_id() {
 }
 
 static std::string ConstructBuildFingerprint(bool legacy) {
-    const std::string UNKNOWN = "unknown";
-    std::string build_fingerprint = GetProperty("ro.product.brand", UNKNOWN);
-    build_fingerprint += '/';
-    build_fingerprint += GetProperty("ro.product.name", UNKNOWN);
-    build_fingerprint += '/';
-    build_fingerprint += GetProperty("ro.product.device", UNKNOWN);
-    build_fingerprint += ':';
-    build_fingerprint += GetProperty("ro.build.version.release_or_codename", UNKNOWN);
-    build_fingerprint += '/';
-
-    std::string build_id =
-            legacy ? GetProperty(LEGACY_ID_PROP, UNKNOWN) : GetProperty(ID_PROP, UNKNOWN);
-    build_fingerprint += build_id;
-    build_fingerprint += '/';
-    build_fingerprint += GetProperty("ro.build.version.incremental", UNKNOWN);
-    build_fingerprint += ':';
-    build_fingerprint += GetProperty("ro.build.type", UNKNOWN);
-    build_fingerprint += '/';
-    build_fingerprint += GetProperty("ro.build.tags", UNKNOWN);
+    
+    std::string build_fingerprint = GetProperty("ro.vendor.build.fingerprint", "");
 
     return build_fingerprint;
 }
-- 
2.17.1

